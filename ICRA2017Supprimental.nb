(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     71477,       1966]
NotebookOptionsPosition[     68995,       1884]
NotebookOutlinePosition[     69556,       1906]
CellTagsIndexPosition[     69513,       1903]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Supprimental", " ", "material", " ", "for", " ", "the", " ", "manuscript",
     " ", "of", " ", 
    RowBox[{"ICRA2017", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Time", " ", "Optimal", " ", "Path", " ", "parameterization", " ", "for", 
     " ", "Omni"}], "-", 
    RowBox[{
    "directional", " ", "Mechanism", " ", "using", " ", "an", " ", "Active", 
     " ", "Caster"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Ryosuke", " ", 
    RowBox[{"Tajima", ":", " ", 
     RowBox[{
      RowBox[{"ryosuke", ".", "tajima"}], " ", "at", " ", 
      RowBox[{"gmail", ".", "com"}]}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6797241942443523`*^9, 3.6797242854943523`*^9}, {
  3.6797244327173524`*^9, 3.6797244384683523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Kinematics", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"p01", ":", " ", 
    RowBox[{"the", " ", "position", " ", "of", " ", "the", " ", "base"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p01", "=", 
     RowBox[{"{", 
      RowBox[{"xd01", ",", "yd01", ",", 
       RowBox[{"zd01", "=", "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{
      RowBox[{"{", "zd01", "}"}], ",", "Constant"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"R01", ":", " ", 
     RowBox[{
     "the", " ", "rotation", " ", "matrix", " ", "of", " ", "the", " ", 
      "base", "\[IndentingNewLine]", 
      RowBox[{"ad01", ":", " ", 
       RowBox[{
       "the", " ", "yaw", " ", "angle", " ", "of", " ", "the", " ", 
        "base"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R01", "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"Cos", "[", "ad01", "]"}], 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "ad01", "]"}]}], "0"},
        {
         RowBox[{"Sin", "[", "ad01", "]"}], 
         RowBox[{"Cos", "[", "ad01", "]"}], "0"},
        {"0", "0", "1"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"p02", ":", " ", 
     RowBox[{"the", " ", "position", " ", "of", " ", "the", " ", "body"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p02", "=", 
     RowBox[{"{", 
      RowBox[{"xd02", ",", "yd02", ",", 
       RowBox[{"zd02", "=", "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{
      RowBox[{"{", "zd02", "}"}], ",", "Constant"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"R02", ":", " ", 
     RowBox[{
     "the", " ", "rotation", " ", "matrix", " ", "of", " ", "the", " ", 
      "body", "\[IndentingNewLine]", 
      RowBox[{"ad02", ":", " ", 
       RowBox[{
       "the", " ", "yaw", " ", "angle", " ", "of", " ", "the", " ", 
        "body"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R02", "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"Cos", "[", "ad02", "]"}], 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "ad02", "]"}]}], "0"},
        {
         RowBox[{"Sin", "[", "ad02", "]"}], 
         RowBox[{"Cos", "[", "ad02", "]"}], "0"},
        {"0", "0", "1"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"p12", ":", " ", 
     RowBox[{
     "the", " ", "offset", " ", "vector", " ", "from", " ", "the", " ", 
      "base", " ", "to", " ", "the", " ", "caster", " ", "joint"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p12", "=", 
     RowBox[{"{", 
      RowBox[{"xd12", ",", 
       RowBox[{"yd12", "=", "0"}], ",", 
       RowBox[{"zd12", "=", "0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xd12", ",", "yd12", ",", "zd12"}], "}"}], ",", "Constant"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"R12", ":", " ", 
     RowBox[{
     "the", " ", "rotation", " ", "matrix", " ", "from", " ", "the", " ", 
      "base", " ", "to", " ", "the", " ", "body", "\[IndentingNewLine]", 
      RowBox[{"ad12", ":", " ", 
       RowBox[{"the", " ", "active", " ", "caster", " ", "angle"}]}]}]}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R12", "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"Cos", "[", "ad12", "]"}], 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "ad12", "]"}]}], "0"},
        {
         RowBox[{"Sin", "[", "ad12", "]"}], 
         RowBox[{"Cos", "[", "ad12", "]"}], "0"},
        {"0", "0", "1"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"w01", ":", " ", 
     RowBox[{
     "the", " ", "angular", " ", "velocity", " ", "of", " ", "the", " ", 
      "base"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w01", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "av01"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"w02", ":", " ", 
     RowBox[{
     "the", " ", "angular", " ", "velocity", " ", "of", " ", "the", " ", 
      "body"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w02", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "av02"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"w12", ":", " ", 
     RowBox[{
     "the", " ", "angular", " ", "velocity", " ", "of", " ", "the", " ", 
      "caster", " ", "joint"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w12", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "av12"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Notation", " ", "rule", " ", "for", " ", "derivatives"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rules", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Dt", "[", "xd01", "]"}], "\[Rule]", "xv01"}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "xv01", "]"}], "\[Rule]", "xa01"}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "yd01", "]"}], "\[Rule]", "yv01"}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "yv01", "]"}], "\[Rule]", "ya01"}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "ad01", "]"}], "\[Rule]", "av01"}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "av01", "]"}], "\[Rule]", "aa01"}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "xd02", "]"}], "\[Rule]", "xv02"}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "xv02", "]"}], "\[Rule]", "xa02"}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "yd02", "]"}], "\[Rule]", "yv02"}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "yv02", "]"}], "\[Rule]", "ya02"}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "ad02", "]"}], "\[Rule]", "av02"}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "av02", "]"}], "\[Rule]", "aa02"}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "ad12", "]"}], "\[Rule]", "av12"}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "av12", "]"}], "\[Rule]", "aa12"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6158734861729636`*^9, 3.615873666124957*^9}, {
   3.617432180263567*^9, 3.6174321825928*^9}, {3.617486732464932*^9, 
   3.617486809265611*^9}, {3.617486854877172*^9, 3.6174868785325375`*^9}, {
   3.6174869327119546`*^9, 3.617486961854869*^9}, {3.6174911524428997`*^9, 
   3.6174911580314584`*^9}, {3.6174914512107735`*^9, 3.617491527034355*^9}, {
   3.617498483961995*^9, 3.6174984898795867`*^9}, {3.6174987316737638`*^9, 
   3.6174987318497815`*^9}, {3.625282291069538*^9, 3.625282304915923*^9}, {
   3.6252844170380435`*^9, 3.625284437336073*^9}, {3.6252844749458337`*^9, 
   3.6252845480051394`*^9}, {3.6252845895022883`*^9, 3.625284595710909*^9}, {
   3.6252846367690144`*^9, 3.6252846474820857`*^9}, {3.6252851786201944`*^9, 
   3.6252852977541065`*^9}, {3.625286280514373*^9, 3.6252862965549765`*^9}, {
   3.6252883662969437`*^9, 3.625288396619976*^9}, {3.6297548955075626`*^9, 
   3.6297549125855627`*^9}, {3.6297552286615624`*^9, 
   3.6297552508125625`*^9}, {3.6297553729157877`*^9, 3.629755540306525*^9}, {
   3.6297555974192357`*^9, 3.629755600100504*^9}, {3.6297557588943815`*^9, 
   3.6297559072962203`*^9}, {3.6297560832848177`*^9, 
   3.6297561030167904`*^9}, {3.629757204142892*^9, 3.6297572231187897`*^9}, {
   3.6297579307935495`*^9, 3.629757950608531*^9}, {3.6297688370936065`*^9, 
   3.629768888183715*^9}, {3.629769078104705*^9, 3.6297691067605705`*^9}, {
   3.62977077452433*^9, 3.629770836509528*^9}, {3.6297739958444443`*^9, 
   3.629774005862446*^9}, 3.6297740985507135`*^9, {3.63011937634931*^9, 
   3.630119432303714*^9}, {3.630119469101034*^9, 3.630119476764268*^9}, {
   3.6301200203727474`*^9, 3.630120161035658*^9}, {3.6301204079363456`*^9, 
   3.63012043008556*^9}, {3.6301205404385943`*^9, 3.630120575111061*^9}, {
   3.6301207732338715`*^9, 3.6301208406976175`*^9}, {3.630121414574999*^9, 
   3.6301214220667486`*^9}, {3.630121519999541*^9, 3.6301216262991695`*^9}, {
   3.63012238248078*^9, 3.6301224700745387`*^9}, {3.6301227027648053`*^9, 
   3.630122719004429*^9}, {3.6301242857066593`*^9, 3.63012433232032*^9}, {
   3.630365707697087*^9, 3.630365746452962*^9}, {3.6303718206923532`*^9, 
   3.630371830950379*^9}, {3.66883350363364*^9, 3.66883351494264*^9}, {
   3.66883354765964*^9, 3.6688335765656395`*^9}, {3.679291449640587*^9, 
   3.679291587252347*^9}, {3.67929385031063*^9, 3.679294347223316*^9}, {
   3.6796980610305195`*^9, 3.679698194674883*^9}, {3.679698531711583*^9, 
   3.6796985914735584`*^9}, {3.679699107900196*^9, 3.6796991197563815`*^9}, {
   3.6796993795413575`*^9, 3.679699457744177*^9}, {3.67970628875821*^9, 
   3.679706378235157*^9}, 3.6797064388302155`*^9, {3.6797089576000676`*^9, 
   3.679708971016409*^9}, 3.6797149539393525`*^9, {3.6797167128133526`*^9, 
   3.6797167292833524`*^9}, {3.6797240782773523`*^9, 
   3.6797241666313524`*^9}, {3.679724333621352*^9, 3.6797243341983523`*^9}, {
   3.679724450840352*^9, 3.6797244530083523`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Solve", " ", "the", " ", "base", " ", "position", " ", "from", " ", 
    "body", " ", "position", " ", "and", " ", "caster", " ", "antgle"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"a1", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"p02", "==", 
      RowBox[{"p01", "+", 
       RowBox[{"R01", ".", "p12"}]}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"xd01", ",", "yd01"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6796982055459695`*^9, 3.679698264004815*^9}, {
   3.6796982977111855`*^9, 3.6796983177041845`*^9}, {3.6796983517125845`*^9, 
   3.679698478085221*^9}, {3.6796990077921863`*^9, 3.6796990331697235`*^9}, {
   3.679705854949834*^9, 3.6797058558129196`*^9}, {3.679706425241857*^9, 
   3.67970645047438*^9}, 3.6797089855648637`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xd01", "\[Rule]", 
     RowBox[{"xd02", "-", 
      RowBox[{"xd12", " ", 
       RowBox[{"Cos", "[", "ad01", "]"}]}]}]}], ",", 
    RowBox[{"yd01", "\[Rule]", 
     RowBox[{"yd02", "-", 
      RowBox[{"xd12", " ", 
       RowBox[{"Sin", "[", "ad01", "]"}]}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.679705857573096*^9, {3.6797064199643292`*^9, 3.6797064508434167`*^9}, {
   3.6797089774820557`*^9, 3.6797089862769346`*^9}, 3.6797135090753527`*^9, 
   3.6797166701733522`*^9, 3.6797183074283524`*^9, 3.6797233142663527`*^9, 
   3.6797243052663527`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Solve", " ", "the", " ", "base", " ", "velocity", " ", "from", " ", "the",
     " ", "body", " ", 
    RowBox[{"velocity", ":", " ", 
     RowBox[{
     "the", " ", "base", " ", "velocity", " ", "is", " ", "constrained", " ", 
      "by", " ", "the", " ", "wheels"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"a2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Dt", "[", "p01", "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{"Dt", "[", "p02", "]"}], "-", 
           RowBox[{"Cross", "[", 
            RowBox[{"w01", ",", 
             RowBox[{"R01", ".", "p12"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Tan", "[", "ad01", "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{"Dt", "[", "yd01", "]"}], "/", 
           RowBox[{"Dt", "[", "xd01", "]"}]}]}]}], "}"}], ",", "  ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Dt", "[", "xd01", "]"}], ",", 
         RowBox[{"Dt", "[", "yd01", "]"}], ",", "av01"}], "}"}]}], "]"}], "/.",
      "rules"}], "//", "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.6796988382972383`*^9, 3.679698934965904*^9}, {
   3.67969905143355*^9, 3.679699098155222*^9}, 3.679699193086714*^9, {
   3.679699274577862*^9, 3.6796992774661508`*^9}, {3.6796993480852118`*^9, 
   3.6796993733017335`*^9}, {3.679699567445146*^9, 3.679699572012603*^9}, {
   3.6796996567200727`*^9, 3.67969979820422*^9}, {3.679699857767175*^9, 
   3.679699900600458*^9}, {3.6797058637507133`*^9, 3.679705864797818*^9}, {
   3.6797064568520174`*^9, 3.6797064771320457`*^9}, {3.6797136508183527`*^9, 
   3.6797136588423524`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xv01", "\[Rule]", 
     RowBox[{
      RowBox[{"Cos", "[", "ad01", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xv02", " ", 
         RowBox[{"Cos", "[", "ad01", "]"}]}], "+", 
        RowBox[{"yv02", " ", 
         RowBox[{"Sin", "[", "ad01", "]"}]}]}], ")"}]}]}], ",", 
    RowBox[{"yv01", "\[Rule]", 
     RowBox[{
      RowBox[{"Cos", "[", "ad01", "]"}], " ", 
      RowBox[{"Sin", "[", "ad01", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"xv02", "+", 
        RowBox[{"yv02", " ", 
         RowBox[{"Tan", "[", "ad01", "]"}]}]}], ")"}]}]}], ",", 
    RowBox[{"av01", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", "ad01", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"yv02", "-", 
         RowBox[{"xv02", " ", 
          RowBox[{"Tan", "[", "ad01", "]"}]}]}], ")"}]}], "xd12"]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6796990805234585`*^9, 3.6796991254569516`*^9, {3.6796992786912737`*^9, 
   3.6796992935357575`*^9}, 3.6796993740408077`*^9, 3.679699422250628*^9, 
   3.6796994599203944`*^9, 3.6796995726206636`*^9, {3.679699744059806*^9, 
   3.679699798539253*^9}, {3.679699859104309*^9, 3.679699866260024*^9}, 
   3.679705673464687*^9, 3.679705865642903*^9, 3.679706478206153*^9, 
   3.6797089933036375`*^9, 3.679709238695174*^9, 3.6797135100533524`*^9, {
   3.6797136524073524`*^9, 3.6797136606773524`*^9}, 3.6797166708963523`*^9, 
   3.679718308234352*^9, 3.6797233154933524`*^9, 3.6797243064813523`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Solve", " ", "the", " ", "base", " ", "acceleration", " ", "from", " ", 
    "the", " ", "body", " ", "acceleration"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"a3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xa01", ",", "ya01"}], "}"}], "==", 
        RowBox[{"Dt", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xv01", ",", "yv01"}], "}"}], "/.", 
          RowBox[{"a2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"xa01", ",", "ya01"}], "}"}]}], "]"}], "/.", "rules"}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.6796994851929216`*^9, 3.6796994949138937`*^9}, {
  3.679699916928091*^9, 3.6797000133327303`*^9}, {3.679700094768873*^9, 
  3.6797001375541515`*^9}, {3.6797056601603565`*^9, 3.679705664446785*^9}, {
  3.6797058077171106`*^9, 3.67970580941228*^9}, {3.679705867591098*^9, 
  3.6797058692862673`*^9}, {3.6797060348768244`*^9, 3.6797061263359694`*^9}, {
  3.6797065152938614`*^9, 3.6797065585591874`*^9}, {3.6797072164239674`*^9, 
  3.679707273496674*^9}, {3.679707311370461*^9, 3.679707463046627*^9}, {
  3.679707495551877*^9, 3.679707572946616*^9}, {3.679707634852806*^9, 
  3.6797076393492556`*^9}, {3.6797090256948767`*^9, 3.679709119570263*^9}, {
  3.6797091985651617`*^9, 3.6797093489782014`*^9}, {3.679710457514044*^9, 
  3.6797104576900616`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xa01", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"xa02", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xa02", "+", 
           RowBox[{"2", " ", "av01", " ", "yv02"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ad01"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "av01", " ", "xv02"}], "+", "ya02"}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "ad01"}], "]"}]}]}], ")"}]}]}], ",", 
    RowBox[{"ya01", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"ya02", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "av01", " ", "xv02"}], "-", "ya02"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ad01"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xa02", "+", 
           RowBox[{"2", " ", "av01", " ", "yv02"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "ad01"}], "]"}]}]}], ")"}]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.679707548809202*^9, 3.679707573475669*^9}, 
   3.6797076400283237`*^9, 3.6797090018404913`*^9, {3.6797090465079575`*^9, 
   3.6797090740317097`*^9}, 3.679709120170323*^9, {3.679709202069512*^9, 
   3.6797092795122557`*^9}, {3.67970934176448*^9, 3.67970934956326*^9}, 
   3.6797135114213524`*^9, 3.6797166716293526`*^9, 3.6797183090093527`*^9, 
   3.6797233162253523`*^9, 3.6797243078573523`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Solve", " ", "the", " ", "base", " ", "acceleration", " ", "from", " ", 
    "the", " ", "body", " ", "acceleration", " ", "by", " ", "another", " ", 
    "formulation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"a4", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Dt", "[", 
           RowBox[{"Dt", "[", "p01", "]"}], "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{"Dt", "[", 
            RowBox[{"Dt", "[", "p02", "]"}], "]"}], "-", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"Dt", "[", 
              RowBox[{"w01", "/.", 
               RowBox[{"a2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"R01", ".", "p12"}]}], "]"}], "-", 
           RowBox[{"Cross", "[", 
            RowBox[{"w01", ",", 
             RowBox[{"Cross", "[", 
              RowBox[{"w01", ",", 
               RowBox[{"R01", ".", "p12"}]}], "]"}]}], "]"}]}]}], "/.", 
         "rules"}], "/.", "rules"}], ",", 
       RowBox[{"{", 
        RowBox[{"xa01", ",", "ya01"}], "}"}]}], "]"}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.679709091891495*^9, 3.6797090945447607`*^9}, {
   3.679709126249931*^9, 3.679709189317237*^9}, {3.6797093954368467`*^9, 
   3.6797094722105236`*^9}, 3.679709764025702*^9, {3.679710231562451*^9, 
   3.6797103139176855`*^9}, {3.679710361055399*^9, 3.6797104296772604`*^9}, {
   3.679710460643357*^9, 3.6797104607703695`*^9}, {3.6797244876983523`*^9, 
   3.6797244884263525`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xa01", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"xa02", "-", 
        RowBox[{"av01", " ", "yv02"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["av01", "2"], " ", "xd12", " ", 
         RowBox[{"Cos", "[", "ad01", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"xa02", "+", 
           RowBox[{"av01", " ", "yv02"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "ad01"}], "]"}]}], "-", 
        RowBox[{"av01", " ", "xv02", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "ad01"}], "]"}]}], "+", 
        RowBox[{"ya02", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "ad01"}], "]"}]}]}], ")"}]}]}], ",", 
    RowBox[{"ya01", "\[Rule]", 
     RowBox[{
      RowBox[{"av01", " ", "xv02"}], "+", "ya02", "-", 
      RowBox[{"ya02", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "ad01", "]"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["av01", "2"], " ", "xd12", " ", 
       RowBox[{"Sin", "[", "ad01", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xa02", "+", 
         RowBox[{"av01", " ", "yv02"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "ad01", "]"}], " ", 
       RowBox[{"Sin", "[", "ad01", "]"}]}], "-", 
      RowBox[{"av01", " ", "xv02", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "ad01", "]"}], "2"]}]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6797166727323523`*^9, 3.6797183101913524`*^9, 
  3.6797233172563524`*^9, 3.6797243094593525`*^9, 3.6797244888763523`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Should", " ", "be", " ", "a3"}], " ", "\[Equal]", " ", "a4"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xa01", ",", "ya01"}], "}"}], "/.", 
        RowBox[{"a3", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "==", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xa01", ",", "ya01"}], "}"}], "/.", 
        RowBox[{"a4", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ")"}], "/.", 
    RowBox[{"a2", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6797104641207047`*^9, 3.6797105366519566`*^9}, {
  3.6797246630143523`*^9, 3.6797246712373524`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6797104998442764`*^9, 3.6797105288351755`*^9}, 
   3.6797135148753524`*^9, 3.679716673800352*^9, 3.6797233173413525`*^9, 
   3.679724310022352*^9, {3.6797246665343523`*^9, 3.6797246720783525`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Solve", " ", "the", " ", "base", " ", "angular", " ", "acceleration", " ",
     "from", " ", "the", " ", "body", " ", "acceleration"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"a5", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"aa01", "==", 
         RowBox[{"Dt", "[", 
          RowBox[{"av01", "/.", 
           RowBox[{"a2", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "/.", "rules"}], ",", 
       "aa01"}], "]"}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6797084772140336`*^9, 3.679708534620774*^9}, {
  3.6797086640407143`*^9, 3.679708749413251*^9}, {3.679709155594865*^9, 
  3.679709176627968*^9}, {3.679710549597251*^9, 3.679710575228814*^9}, {
  3.6797106071760087`*^9, 3.6797106777300634`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"aa01", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "av01"}], " ", "xv02"}], "+", "ya02"}], ")"}], " ", 
       RowBox[{"Cos", "[", "ad01", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xa02", "+", 
         RowBox[{"av01", " ", "yv02"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "ad01", "]"}]}]}], "xd12"]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.679710666149905*^9, 3.6797106780961*^9}, 
   3.6797135161433525`*^9, 3.6797166748883524`*^9, 3.6797233179013524`*^9, 
   3.679724311406352*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Solve", " ", "the", " ", "base", " ", "angular", " ", "acceleration", " ",
     "from", " ", "the", " ", "body", " ", "acceleration", " ", "by", " ", 
    "another", " ", "formulation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"a6", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Dt", "[", "w01", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"Dt", "[", "w02", "]"}], "-", 
         RowBox[{"R01", ".", 
          RowBox[{"Dt", "[", 
           RowBox[{
            RowBox[{"w02", "-", "w01"}], "/.", 
            RowBox[{"a2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "-", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"w01", "/.", 
             RowBox[{"a2", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], ",", 
           RowBox[{"R01", ".", "w12"}]}], "]"}]}]}], "/.", "rules"}], ",", 
      RowBox[{"{", "aa01", "}"}]}], "]"}], "//", "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.6797107010423946`*^9, 3.6797107049377837`*^9}, {
  3.6797135239453526`*^9, 3.6797136012053523`*^9}, {3.6797137307173524`*^9, 
  3.679713748932352*^9}, {3.6797138791323524`*^9, 3.6797138987383523`*^9}, {
  3.6797139310483522`*^9, 3.679713941687352*^9}, {3.679714780194352*^9, 
  3.6797148036643524`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"aa01", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "av01"}], " ", "xv02"}], "+", "ya02"}], ")"}], " ", 
       RowBox[{"Cos", "[", "ad01", "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xa02", "+", 
         RowBox[{"av01", " ", "yv02"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "ad01", "]"}]}]}], "xd12"]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6797135289833527`*^9, 3.6797136015663524`*^9}, {
   3.6797137330183525`*^9, 3.6797137492543526`*^9}, {3.679713887812352*^9, 
   3.6797138990923524`*^9}, {3.679713933272352*^9, 3.6797139464883523`*^9}, {
   3.6797147860893526`*^9, 3.6797148039533525`*^9}, 3.6797166757523527`*^9, 
   3.6797233184523525`*^9, 3.6797243124943523`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Should", " ", "be", " ", "a5"}], " ", "\[Equal]", " ", "a6"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"aa01", "/.", "a5"}], ")"}], "==", 
   RowBox[{"(", 
    RowBox[{"aa01", "/.", "a6"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6797140942613525`*^9, 3.6797140969483523`*^9}, {
  3.6797148178303523`*^9, 3.6797148484523525`*^9}, {3.6797246508393526`*^9, 
  3.6797246512943525`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6797148502683525`*^9, 3.679716676496352*^9, 
  3.679723319220352*^9, 3.679724313621352*^9, 3.6797246538153524`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Solve", " ", "the", " ", "wheel", " ", "velocity", " ", "from", " ", 
    "the", " ", "base", " ", "velocity"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"a7", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xv11", ",", " ", "av01"}], "}"}], "\[Equal]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"wl", "+", "wr"}], ")"}], "*", 
          RowBox[{"W", "/", "2"}]}], ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"wr", "-", "wl"}], ")"}], "*", 
          RowBox[{"W", "/", "D"}]}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"wl", ",", "wr"}], "}"}]}], "]"}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.679714130906352*^9, 3.6797142885533524`*^9}, {
   3.679714328366352*^9, 3.679714329878352*^9}, 3.679714390043352*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"wl", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"av01", " ", "D"}], "-", 
        RowBox[{"2", " ", "xv11"}]}], 
       RowBox[{"2", " ", "W"}]]}]}], ",", 
    RowBox[{"wr", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"av01", " ", "D"}], "+", 
       RowBox[{"2", " ", "xv11"}]}], 
      RowBox[{"2", " ", "W"}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.679714256864352*^9, 3.679714288932352*^9}, 
   3.6797143301623526`*^9, 3.6797143904203525`*^9, 3.6797166773283525`*^9, 
   3.6797233198693523`*^9, 3.6797243146133523`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Dynamics", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"p1g", ":", " ", 
    RowBox[{
    "the", " ", "center", " ", "of", " ", "the", " ", "mass", " ", "of", " ", 
     "the", " ", "base"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p1g", "=", 
     RowBox[{"{", 
      RowBox[{"x1g", ",", "y1g", ",", "z1g"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1g", ",", "y1g", ",", "z1g"}], "}"}], ",", "Constant"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"p2g", ":", " ", 
     RowBox[{
     "the", " ", "center", " ", "of", " ", "the", " ", "mass", " ", "of", " ",
       "the", " ", "body"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p2g", "=", 
     RowBox[{"{", 
      RowBox[{"x2g", ",", "y2g", ",", "z2g"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x2g", ",", "y2g", ",", "z2g"}], "}"}], ",", "Constant"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"p01g", ":", " ", 
     RowBox[{
     "the", " ", "center", " ", "of", " ", "the", " ", "mass", " ", "of", " ",
       "the", " ", "body", " ", "from", " ", "the", " ", "world"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p01g", "=", 
     RowBox[{
      RowBox[{"R01", ".", "p1g"}], "+", "p01"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"p12g", ":", " ", 
     RowBox[{
     "the", " ", "center", " ", "of", " ", "the", " ", "mass", " ", "of", " ",
       "the", " ", "body", " ", "from", " ", "the", " ", "base"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p12g", "=", 
     RowBox[{
      RowBox[{"R12", ".", "p2g"}], "+", "p12"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"p02g", ":", " ", 
     RowBox[{
     "the", " ", "center", " ", "of", " ", "the", " ", "mass", " ", "of", " ",
       "the", " ", "body", " ", "from", " ", "the", " ", "world"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p02g", "=", 
     RowBox[{
      RowBox[{"R01", ".", "p12g"}], "+", "p01"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"f02", ":", " ", 
     RowBox[{
     "the", " ", "external", " ", "force", " ", "to", " ", "the", " ", 
      "body"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f02", "=", 
     RowBox[{"{", 
      RowBox[{"fx02", ",", "fy02", ",", "fz02"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"m1", ",", 
     RowBox[{"m2", ":", " ", 
      RowBox[{
      "the", " ", "mass", " ", "of", " ", "the", " ", "base", " ", "and", " ",
        "body"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m1", ",", "m2"}], "}"}], ",", "Constant"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"I11", ":", " ", 
     RowBox[{
     "the", " ", "inertia", " ", "matrix", " ", "of", " ", "the", " ", 
      "base"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"I11", "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"Ixx11", "=", "0"}], "0", "0"},
        {"0", 
         RowBox[{"Iyy11", "=", "0"}], "0"},
        {"0", "0", "Izz11"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ixx11", ",", "Iyy11", ",", "Izz11"}], "}"}], ",", 
      "Constant"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"I22", ":", " ", 
     RowBox[{
     "the", " ", "inertia", " ", "matrix", " ", "of", " ", "the", " ", 
      "base"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"I22", "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"Ixx22", "=", "0"}], "0", "0"},
        {"0", 
         RowBox[{"Iyy22", "=", "0"}], "0"},
        {"0", "0", "Izz22"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Ixx22", ",", "Iyy22", ",", "Izz22"}], "}"}], ",", 
      "Constant"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6797149111933527`*^9, 3.679714915720352*^9}, {
  3.6797149587973523`*^9, 3.6797149589813523`*^9}, {3.679715032057352*^9, 
  3.679715072470352*^9}, {3.6797152120383525`*^9, 3.6797152493253527`*^9}, {
  3.6797152915393524`*^9, 3.6797152925133524`*^9}, {3.6797154015373526`*^9, 
  3.679715544024352*^9}, {3.6797156168113527`*^9, 3.6797157221923523`*^9}, {
  3.6797158730353527`*^9, 3.679715932220352*^9}, {3.6797159798083525`*^9, 
  3.679716014366352*^9}, {3.6797170275523524`*^9, 3.6797170319663525`*^9}, {
  3.6797171363203526`*^9, 3.679717140463352*^9}, {3.6797172533373528`*^9, 
  3.679717308772352*^9}, {3.6797185492773523`*^9, 3.679718648989352*^9}, {
  3.6797186866043525`*^9, 3.6797186877563524`*^9}, {3.679722138614352*^9, 
  3.6797221422543526`*^9}, {3.6797233012313523`*^9, 3.6797233023513527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "motion", " ", "equation", " ", "of", " ", "the", " ", 
    "body"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f02", "=", 
     RowBox[{"m2", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"p02g", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t02", "=", 
     RowBox[{
      RowBox[{"R02", ".", "I22", ".", 
       RowBox[{"Dt", "[", "w02", "]"}]}], "+", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"R01", ".", "R12", ".", "p2g"}], ",", 
        RowBox[{"(", 
         RowBox[{"m2", " ", 
          RowBox[{"Dt", "[", 
           RowBox[{"p02g", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], ")"}]}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6797149987233524`*^9, 3.679715025682352*^9}, {
  3.679715102484352*^9, 3.679715123187352*^9}, {3.6797152961363525`*^9, 
  3.6797153769553523`*^9}, {3.6797155510963526`*^9, 3.6797155515673523`*^9}, {
  3.6797155822373524`*^9, 3.679715596293352*^9}, {3.6797157358773527`*^9, 
  3.6797158635793524`*^9}, {3.6797159472943525`*^9, 3.6797159501583524`*^9}, {
  3.6797160576073523`*^9, 3.679716078246352*^9}, {3.679717078550352*^9, 
  3.6797171074993525`*^9}, {3.6797172227253523`*^9, 3.679717224036352*^9}, {
  3.679718786168352*^9, 3.6797187998873525`*^9}, {3.6797190519833527`*^9, 
  3.6797190589263525`*^9}, {3.6797209619163523`*^9, 3.6797209672043524`*^9}, {
  3.6797215060493526`*^9, 3.6797215140493526`*^9}, {3.6797216032033525`*^9, 
  3.6797216275853524`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "conversion", " ", "from", " ", "tire", " ", "torque", " ", 
    "to", " ", "the", " ", "body", " ", "force"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f11", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"tr", "+", "tl"}], ")"}], "/", "W"}], ",", " ", "fy11", ",", 
       " ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t11", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", 
       RowBox[{"D", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"tr", "-", "tl"}], ")"}], "/", "W"}], "/", "2"}]}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f01", "=", 
     RowBox[{"R01", ".", "f11"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t01", "=", 
     RowBox[{"R01", ".", "t11"}]}], ";"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "motion", " ", "equation", " ", "of", " ", "the", " ", 
    "base"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"e1x", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"f01", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m1", " ", 
           RowBox[{"Dt", "[", 
            RowBox[{"p01g", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "+", "f02"}], ")"}], 
        "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"e1y", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"f01", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m1", " ", 
           RowBox[{"Dt", "[", 
            RowBox[{"p01g", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "+", "f02"}], ")"}], 
        "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"e1z", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"t01", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R01", ".", "I11", ".", 
           RowBox[{"Dt", "[", "w01", "]"}]}], "+", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"R01", ".", "p1g"}], ",", 
            RowBox[{"(", 
             RowBox[{"m1", " ", 
              RowBox[{"Dt", "[", 
               RowBox[{"p01g", ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], ")"}]}], "]"}], 
          "+", "t02", "+", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"R01", ".", "p12"}], ",", "f02"}], "]"}]}], ")"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6797216793353524`*^9, 3.679721694206352*^9}, {
  3.679721733996352*^9, 3.6797217390113525`*^9}, {3.6797221606973524`*^9, 
  3.6797221620003524`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Solve", " ", "the", " ", "motion", " ", "equation", " ", "to", " ", 
     "obtain", " ", "tl"}], ",", " ", "tr", ",", " ", "fy11"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ans1", "=", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e1x", ",", "e1y", ",", "e1z"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"tl", ",", "tr", ",", "fy11"}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.6797162774723525`*^9, 3.6797163248143525`*^9}, {
   3.6797164153763523`*^9, 3.6797164368873525`*^9}, {3.6797169054173527`*^9, 
   3.6797169191193523`*^9}, {3.6797175436633525`*^9, 
   3.6797175491993523`*^9}, {3.6797176827263527`*^9, 
   3.6797176841103525`*^9}, {3.679720230555352*^9, 3.6797202604093523`*^9}, 
   3.6797203712903523`*^9, {3.6797204772993526`*^9, 3.6797204798343525`*^9}, {
   3.6797205389273524`*^9, 3.6797205640613527`*^9}, {3.6797205998353524`*^9, 
   3.6797206010993524`*^9}, {3.6797206369933524`*^9, 3.6797206466973524`*^9}, 
   3.6797208829213524`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Parameterization", " ", "by", " ", "s"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"param1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"xd01", ",", "t"}], "]"}], "\[Rule]", 
        RowBox[{"xv01", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"s", ",", "t"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"xd01", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"xv01", " ", 
          RowBox[{"Dt", "[", 
           RowBox[{"s", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "+", 
         RowBox[{"xa01", " ", 
          RowBox[{
           RowBox[{"Dt", "[", 
            RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}]}]}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"param2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"yd01", ",", "t"}], "]"}], "\[Rule]", 
        RowBox[{"yv01", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"s", ",", "t"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"yd01", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"yv01", " ", 
          RowBox[{"Dt", "[", 
           RowBox[{"s", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "+", 
         RowBox[{"ya01", " ", 
          RowBox[{
           RowBox[{"Dt", "[", 
            RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}]}]}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"param3", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"ad01", ",", "t"}], "]"}], "\[Rule]", 
        RowBox[{"av01", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"s", ",", "t"}], "]"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"ad01", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"av01", " ", 
          RowBox[{"Dt", "[", 
           RowBox[{"s", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "+", 
         RowBox[{"aa01", " ", 
          RowBox[{
           RowBox[{"Dt", "[", 
            RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}]}]}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"param4", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"ad12", ",", "t"}], "]"}], "\[Rule]", 
        RowBox[{"av12", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"s", ",", "t"}], "]"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"ad12", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"av12", " ", 
          RowBox[{"Dt", "[", 
           RowBox[{"s", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "+", 
         RowBox[{"aa12", " ", 
          RowBox[{
           RowBox[{"Dt", "[", 
            RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}]}]}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"param5", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Dt", "[", "av01", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"av01", " ", 
          RowBox[{"Dt", "[", 
           RowBox[{"s", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "+", 
         RowBox[{"aa01", " ", 
          RowBox[{
           RowBox[{"Dt", "[", 
            RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"Dt", "[", "av02", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"av02", " ", 
          RowBox[{"Dt", "[", 
           RowBox[{"s", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "+", 
         RowBox[{"aa02", " ", 
          RowBox[{
           RowBox[{"Dt", "[", 
            RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}]}]}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.625286677277045*^9, 3.6252869039987144`*^9}, {
  3.629759905225992*^9, 3.629759957747244*^9}, {3.6297601446589327`*^9, 
  3.629760253310797*^9}, {3.629760290792545*^9, 3.629760322408706*^9}, {
  3.629760924679927*^9, 3.6297609315326123`*^9}, {3.6297740369085503`*^9, 
  3.6297740379896584`*^9}, {3.629774110495908*^9, 3.6297741237042284`*^9}, {
  3.6303717774430285`*^9, 3.630371803668651*^9}, {3.630371944256708*^9, 
  3.6303719638486676`*^9}, {3.6797206531603527`*^9, 3.6797207025443525`*^9}, {
  3.6797208985203524`*^9, 3.6797209122503524`*^9}, {3.679721817623352*^9, 
  3.6797218246193523`*^9}, {3.6797219812433524`*^9, 3.6797220194763527`*^9}, {
  3.679722063833352*^9, 3.6797221170703526`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Parameterize", " ", "the", " ", "answer", " ", "of", " ", "the", " ", 
    "equation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ans2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tl", ",", "tr", ",", "fy11", ",", 
            RowBox[{"t02", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/.", 
          RowBox[{"ans1", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "/.", "param1"}], "/.", 
        "param2"}], "/.", "param3"}], "/.", "param4"}], "/.", "param5"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.6797222250263524`*^9, 3.679722227706352*^9}, {
  3.6797223111413527`*^9, 3.679722341003352*^9}, {3.679722571965352*^9, 
  3.6797225726443524`*^9}, {3.679722679734352*^9, 3.6797226904293523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Constraint", " ", "parameters", 
    RowBox[{"(", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], ")"}], " ", "of", " ", 
    "the", " ", "left", " ", "wheel", " ", "torque"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Al", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Bl", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Cl", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", "t"}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Dl", "=", 
     RowBox[{
      RowBox[{"ans2", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "-", 
      RowBox[{"Al", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "-", 
      RowBox[{"Bl", "  ", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}], " ", "-", 
      RowBox[{"Cl", "  ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", "t"}], "]"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.62976969931782*^9, 3.6297697516650543`*^9}, {
   3.6297698569095774`*^9, 3.629769882626149*^9}, 3.629770044580343*^9, 
   3.630122892975731*^9, {3.6797210107313523`*^9, 3.679721011687352*^9}, {
   3.679722030713352*^9, 3.6797220322653522`*^9}, {3.6797221803283525`*^9, 
   3.6797222169413524`*^9}, {3.6797223542523527`*^9, 
   3.6797223996813526`*^9}, {3.679722706524352*^9, 3.679722706739352*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Al", "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.679724369930352*^9, 3.6797243751043525`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "D"}]], 
   RowBox[{"W", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "av01", " ", "Izz11"}], "+", 
      RowBox[{"2", " ", "av02", " ", "Izz22"}], "+", 
      RowBox[{"2", " ", "av01", " ", "m1", " ", 
       SuperscriptBox["x1g", "2"]}], "+", 
      RowBox[{"2", " ", "av01", " ", "m2", " ", 
       SuperscriptBox["x2g", "2"]}], "+", 
      RowBox[{"2", " ", "av12", " ", "m2", " ", 
       SuperscriptBox["x2g", "2"]}], "+", 
      RowBox[{"2", " ", "av01", " ", "m2", " ", 
       SuperscriptBox["xd12", "2"]}], "+", 
      RowBox[{"av01", " ", "D", " ", "m1", " ", "y1g"}], "+", 
      RowBox[{"2", " ", "av01", " ", "m1", " ", 
       SuperscriptBox["y1g", "2"]}], "+", 
      RowBox[{"2", " ", "av01", " ", "m2", " ", 
       SuperscriptBox["y2g", "2"]}], "+", 
      RowBox[{"2", " ", "av12", " ", "m2", " ", 
       SuperscriptBox["y2g", "2"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"D", " ", 
          RowBox[{"(", 
           RowBox[{"m1", "+", "m2"}], ")"}], " ", "xv01"}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "m1"}], " ", "xv01", " ", "y1g"}], "+", 
            RowBox[{"m1", " ", "x1g", " ", "yv01"}], "+", 
            RowBox[{"m2", " ", "xd12", " ", "yv01"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "ad01", "]"}]}], "+", 
      RowBox[{"m2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "av01", " ", "x2g", " ", "xd12"}], "+", 
         RowBox[{"2", " ", "av12", " ", "x2g", " ", "xd12"}], "+", 
         RowBox[{"av01", " ", "D", " ", "y2g"}], "+", 
         RowBox[{"av12", " ", "D", " ", "y2g"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "ad12", "]"}]}], "-", 
      RowBox[{"2", " ", "m2", " ", "xv01", " ", "y2g", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"ad01", "+", "ad12"}], "]"}]}], "+", 
      RowBox[{"2", " ", "m2", " ", "x2g", " ", "yv01", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"ad01", "+", "ad12"}], "]"}]}], "-", 
      RowBox[{"2", " ", "m1", " ", "x1g", " ", "xv01", " ", 
       RowBox[{"Sin", "[", "ad01", "]"}]}], "-", 
      RowBox[{"2", " ", "m2", " ", "xd12", " ", "xv01", " ", 
       RowBox[{"Sin", "[", "ad01", "]"}]}], "-", 
      RowBox[{"D", " ", "m1", " ", "yv01", " ", 
       RowBox[{"Sin", "[", "ad01", "]"}]}], "-", 
      RowBox[{"D", " ", "m2", " ", "yv01", " ", 
       RowBox[{"Sin", "[", "ad01", "]"}]}], "-", 
      RowBox[{"2", " ", "m1", " ", "y1g", " ", "yv01", " ", 
       RowBox[{"Sin", "[", "ad01", "]"}]}], "+", 
      RowBox[{"av01", " ", "D", " ", "m2", " ", "x2g", " ", 
       RowBox[{"Sin", "[", "ad12", "]"}]}], "+", 
      RowBox[{"av12", " ", "D", " ", "m2", " ", "x2g", " ", 
       RowBox[{"Sin", "[", "ad12", "]"}]}], "-", 
      RowBox[{"4", " ", "av01", " ", "m2", " ", "xd12", " ", "y2g", " ", 
       RowBox[{"Sin", "[", "ad12", "]"}]}], "-", 
      RowBox[{"2", " ", "av12", " ", "m2", " ", "xd12", " ", "y2g", " ", 
       RowBox[{"Sin", "[", "ad12", "]"}]}], "-", 
      RowBox[{"2", " ", "m2", " ", "x2g", " ", "xv01", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"ad01", "+", "ad12"}], "]"}]}], "-", 
      RowBox[{"2", " ", "m2", " ", "y2g", " ", "yv01", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"ad01", "+", "ad12"}], "]"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.6797243707373524`*^9, 3.6797243760943527`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Constraint", " ", "parameters", 
    RowBox[{"(", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], ")"}], " ", "of", " ", 
    "the", " ", "right", " ", "wheel", " ", "torque"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Ar", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans2", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Br", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans2", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Cr", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans2", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", "t"}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Dr", "=", 
     RowBox[{
      RowBox[{"ans2", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "-", 
      RowBox[{"Ar", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "-", 
      RowBox[{"Br", "  ", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}], " ", "-", 
      RowBox[{"Cr", "  ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", "t"}], "]"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.625287850649062*^9, 3.625287853249062*^9}, {
  3.6297700573156166`*^9, 3.629770068012686*^9}, {3.629776107666605*^9, 
  3.6297761115929976`*^9}, {3.6297787785305257`*^9, 3.6297787792345963`*^9}, {
  3.6301228802887306`*^9, 3.6301229003857307`*^9}, {3.6797224518133526`*^9, 
  3.6797224562913523`*^9}, {3.6797227113553524`*^9, 3.6797227117233524`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Constraint", " ", "parameters", 
     RowBox[{"(", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], ")"}], " ", "of", " ", 
     "the", " ", "base", " ", "y"}], "-", 
    RowBox[{"axis", " ", "force"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"As", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans2", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Bs", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans2", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Cs", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans2", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", "t"}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Ds", "=", 
     RowBox[{
      RowBox[{"ans2", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "-", 
      RowBox[{"As", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "-", 
      RowBox[{"Bs", "  ", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}], " ", "-", 
      RowBox[{"Cs", "  ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", "t"}], "]"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.625288179816298*^9, 3.625288195785895*^9}, {
   3.629770128821766*^9, 3.6297701486437483`*^9}, {3.6297788061322856`*^9, 
   3.6297788078914614`*^9}, 3.630122915990731*^9, {3.6797224952573524`*^9, 
   3.6797225439263525`*^9}, {3.6797227161393523`*^9, 3.6797227520563526`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Constraint", " ", "parameters", 
    RowBox[{"(", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], ")"}], " ", "of", " ", 
    "caster", " ", "joint", " ", "torque"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Az", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans2", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Bz", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans2", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Cz", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans2", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", "t"}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Dz", "=", 
     RowBox[{
      RowBox[{"ans2", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "-", 
      RowBox[{"Az", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "-", 
      RowBox[{"Bz", "  ", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}], " ", "-", 
      RowBox[{"Cz", "  ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", "t"}], "]"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6297702114310265`*^9, 3.6297702616510477`*^9}, {
   3.6297751638172293`*^9, 3.6297751674485927`*^9}, {3.6297788244531174`*^9, 
   3.6297788274604187`*^9}, 3.630122927285731*^9, {3.6797227014763527`*^9, 
   3.679722738531352*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Dynamics", " ", "to", " ", "compute", " ", "ZMP", " ", "constraints"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"g", ":", " ", 
    RowBox[{"gravity", " ", "constants"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"g", ",", "Constant"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"p0g", ":", " ", 
     RowBox[{
     "the", " ", "position", " ", "of", " ", "the", " ", "robot", " ", 
      "COG"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p0g", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m1", " ", "p01g"}], "+", 
        RowBox[{"m2", " ", "p02g"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"m1", "+", "m2"}], ")"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6797232084193525`*^9, 3.6797232086593523`*^9}, {
  3.679724354090352*^9, 3.6797243545863523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x0q", ",", " ", "y0q"}], "}"}], ":", " ", 
      RowBox[{"Zero", " ", "moment", " ", "point", " ", "on", " ", "z"}]}], 
     "=", "0"}], ",", " ", 
    RowBox[{"originated", " ", "from", " ", "the", " ", "world"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x0q", "=", 
     RowBox[{
      RowBox[{"p0g", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Dt", "[", 
        RowBox[{
         RowBox[{"p0g", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}], " ", 
       RowBox[{
        RowBox[{"p0g", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/", "g"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"y0q", "=", 
     RowBox[{
      RowBox[{"p0g", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Dt", "[", 
        RowBox[{
         RowBox[{"p0g", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}], " ", 
       RowBox[{
        RowBox[{"p0g", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/", "g"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6252888590412135`*^9, 3.625288943084617*^9}, {
  3.625289009400248*^9, 3.6252890799052978`*^9}, {3.6252891271960263`*^9, 
  3.62528923544085*^9}, {3.6297703953134127`*^9, 3.6297704829721775`*^9}, {
  3.629776480001626*^9, 3.629776526375988*^9}, {3.6297767432832327`*^9, 
  3.629776819216233*^9}, {3.6797230371523523`*^9, 3.679723162616352*^9}, {
  3.6797231975263524`*^9, 3.6797232773443527`*^9}, {3.6797234149343524`*^9, 
  3.679723421781352*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Convert", " ", "the", " ", "ZMP", " ", "originated", " ", "from", " ", 
    "the", " ", "base"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ans4", "=", 
    RowBox[{
     RowBox[{"Transpose", "[", "R01", "]"}], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x0q", ",", "y0q", ",", "0"}], "}"}], "-", "p01"}], ")"}]}]}],
    ";"}]}]], "Input",
 CellChangeTimes->{{3.625289217230029*^9, 3.6252892713824434`*^9}, {
   3.625289319787284*^9, 3.6252893642527294`*^9}, 3.625289489810284*^9, {
   3.6252895726205645`*^9, 3.625289582008503*^9}, {3.6297705094528255`*^9, 
   3.6297705238332634`*^9}, {3.6297705622801075`*^9, 
   3.6297705691497946`*^9}, {3.629770619856865*^9, 3.629770622720151*^9}, {
   3.629776828883233*^9, 3.6297768293612328`*^9}, {3.6297774955012355`*^9, 
   3.6297774971003957`*^9}, 3.629777581878873*^9, {3.630124704166501*^9, 
   3.630124727468831*^9}, {3.6797233931913524`*^9, 3.6797234081343527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Parameterize", " ", "by", " ", "s"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ans5", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ans4", "/.", "param1"}], "/.", "param2"}], "/.", "param3"}], 
      "/.", "param4"}], "/.", "param5"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.625289366694974*^9, 3.625289383719676*^9}, {
  3.6252896228445864`*^9, 3.625289623454647*^9}, {3.629772078443709*^9, 
  3.6297721378946533`*^9}, {3.6797234893693523`*^9, 3.6797234911373525`*^9}, {
  3.6797245449333525`*^9, 3.679724561220352*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Constraint", " ", "parameters", 
    RowBox[{"(", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], ")"}], " ", "of", " ", 
    "the", " ", "ZMP", " ", 
    RowBox[{"(", "x", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AzmpX", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans5", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"BzmpX", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans5", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"CzmpX", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans5", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", "t"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DzmpX", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ans5", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"AzmpX", " ", 
        RowBox[{"Dt", "[", 
         RowBox[{"s", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "-", 
       RowBox[{"BzmpX", " ", 
        RowBox[{
         RowBox[{"Dt", "[", 
          RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}], "-", 
       RowBox[{"CzmpX", " ", 
        RowBox[{"Dt", "[", 
         RowBox[{"s", ",", "t"}], "]"}]}]}], "//", "FullSimplify"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6252896487261744`*^9, 3.6252896869519963`*^9}, {
   3.629772111926057*^9, 3.629772116437508*^9}, {3.6297763863164673`*^9, 
   3.629776393572193*^9}, {3.629776555317094*^9, 3.6297765557760477`*^9}, {
   3.62977752064575*^9, 3.6297775237030554`*^9}, {3.629777802887971*^9, 
   3.6297778045361357`*^9}, {3.6297778936910505`*^9, 3.6297778989395757`*^9}, 
   3.630365545204839*^9, {3.6797234958503523`*^9, 3.679723604234352*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Constraint", " ", "parameters", 
    RowBox[{"(", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], ")"}], " ", "of", " ", 
    "the", " ", "ZMP", " ", 
    RowBox[{"(", "y", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AzmpY", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans5", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"BzmpY", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans5", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"CzmpY", "=", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"ans5", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", "t"}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"DzmpY", "=", 
     RowBox[{
      RowBox[{"ans5", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "-", 
      RowBox[{"AzmpY", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}]}], "-", 
      RowBox[{"BzmpY", " ", 
       RowBox[{
        RowBox[{"Dt", "[", 
         RowBox[{"s", ",", "t"}], "]"}], "^", "2"}]}], "-", 
      RowBox[{"CzmpY", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"s", ",", "t"}], "]"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.625289805928893*^9, 3.6252898303723373`*^9}, {
   3.6297722555714197`*^9, 3.6297722661224747`*^9}, {3.6297775932810125`*^9, 
   3.629777593932078*^9}, {3.6297783315148287`*^9, 3.6297783323069077`*^9}, 
   3.630365791905507*^9, 3.6303720833616176`*^9, {3.6797238174783525`*^9, 
   3.6797238392053523`*^9}, {3.6797240298893523`*^9, 3.679724038951352*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "D", " ", "should", " ", "be", " ", "identical", " ", "with", " ", "COG"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p01", "+", 
     RowBox[{"R01", ".", 
      RowBox[{"{", 
       RowBox[{"DzmpX", ",", "DzmpY", ",", 
        RowBox[{"p0g", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "==", "p0g"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.630365578224141*^9, 3.6303655846437826`*^9}, 
   3.6797238452583523`*^9, {3.6797239142303524`*^9, 3.6797239644343524`*^9}, {
   3.6797240560453525`*^9, 3.6797240596893525`*^9}, {3.679724604970352*^9, 
   3.6797246408953524`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6797239476033525`*^9, 3.6797239842773523`*^9, {3.679724041503352*^9, 
   3.6797240601863527`*^9}, 3.679724364852352*^9, {3.6797246061203527`*^9, 
   3.6797246414643526`*^9}}]
}, Open  ]]
},
WindowSize->{1163, 875},
WindowMargins->{{302, Automatic}, {38, Automatic}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.1999999999999, 841.68}},
Magnification->1.2000000476837158`,
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (2011\:5e743\:670821\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 879, 22, 75, "Input"],
Cell[1439, 44, 9445, 217, 718, "Input"],
Cell[CellGroupData[{
Cell[10909, 265, 845, 19, 55, "Input"],
Cell[11757, 286, 636, 16, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12430, 307, 1754, 42, 55, "Input"],
Cell[14187, 351, 1555, 38, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15779, 394, 1529, 34, 55, "Input"],
Cell[17311, 430, 1711, 46, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19059, 481, 1685, 41, 95, "Input"],
Cell[20747, 524, 1672, 45, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22456, 574, 850, 25, 55, "Input"],
Cell[23309, 601, 251, 3, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23597, 609, 899, 23, 75, "Input"],
Cell[24499, 634, 675, 20, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25211, 659, 1416, 34, 55, "Input"],
Cell[26630, 695, 863, 22, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27530, 722, 498, 13, 55, "Input"],
Cell[28031, 737, 168, 2, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28236, 744, 961, 27, 55, "Input"],
Cell[29200, 773, 661, 19, 53, "Output"]
}, Open  ]],
Cell[29876, 795, 5367, 141, 557, "Input"],
Cell[35246, 938, 1682, 40, 75, "Input"],
Cell[36931, 980, 981, 31, 115, "Input"],
Cell[37915, 1013, 2250, 68, 95, "Input"],
Cell[40168, 1083, 1112, 25, 55, "Input"],
Cell[41283, 1110, 5154, 148, 135, "Input"],
Cell[46440, 1260, 908, 24, 55, "Input"],
Cell[47351, 1286, 2114, 58, 115, "Input"],
Cell[CellGroupData[{
Cell[49490, 1348, 126, 2, 34, "Input"],
Cell[49619, 1352, 3514, 77, 166, "Output"]
}, Open  ]],
Cell[53148, 1432, 2068, 57, 115, "Input"],
Cell[55219, 1491, 2029, 57, 115, "Input"],
Cell[57251, 1550, 1935, 56, 115, "Input"],
Cell[59189, 1608, 1023, 29, 115, "Input"],
Cell[60215, 1639, 1804, 50, 75, "Input"],
Cell[62022, 1691, 1029, 22, 55, "Input"],
Cell[63054, 1715, 640, 16, 55, "Input"],
Cell[63697, 1733, 2235, 61, 115, "Input"],
Cell[65935, 1796, 2085, 57, 115, "Input"],
Cell[CellGroupData[{
Cell[68045, 1857, 701, 18, 55, "Input"],
Cell[68749, 1877, 230, 4, 35, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
